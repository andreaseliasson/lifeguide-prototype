<html>
<head>
  <title>d3-adjacency-matrix-layout example</title>
  <meta charset='utf-8' />
  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/4.2.2/d3.min.js'></script>
  <script src='d3-adjacency-matrix-layout.js' type='text/JavaScript'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.10.3/babel.min.js'></script>
  <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
</head>
<style>
  svg {
    border: 0px solid gray;
  }
  g.am-axis text {
    font-size: 8px;
  }

  .domain {
    fill: none;
  }

  .tick > line{
    stroke: black;
    stroke-width: 1px;
    stroke-opacity: 0.25;
  }
</style>
<body>
<div id='viz'>
  <svg height='960px' width='960px'></svg>
</div>
<div id='controls' />
</body>
<footer>
  <script lang='babel' type='text/babel'>
    d3.json('page-example2.json', createAdjacencyMatrix);

    function createAdjacencyMatrix(data) {
      const adjacencyMatrix = d3.adjacencyMatrixLayout();
      console.log('adjacencyMatrix', adjacencyMatrix);
      console.log('d3', d3);

      adjacencyMatrix
        .size([870,870])
        .nodes(data.nodes)
        .links(data.links)
        .directed(true)
        .nodeID(d => d.name);

      const matrixData = adjacencyMatrix();

      console.log(matrixData);

      const colors = ['#fdbe85','#fd8d3c','#d94701'];

      const colorScale = d3.scaleQuantile()
        .domain([0, d3.max(matrixData, (d) => d.value)])
        .range(colors);

      d3.select('svg')
        .append('g')
        .attr('transform', 'translate(80,80)')
        .attr('id', 'adjacencyG')
        .selectAll('rect')
        .data(matrixData)
        .enter()
        .append('rect')
        .attr('width', d => d.width)
        .attr('height', d => d.height)
        .attr('x', d => d.x)
        .attr('y', d => d.y)
        .style('stroke', 'black')
        .style('stroke-width', '1px')
        .style('stroke-opacity', .1)
        .style('fill', d => colorScale(d.value))
        .style('fill-opacity', d => d.weight * 0.8)
        .append('title')
          .text(function(d) {
          return d.source.name + " -> " + d.target.name + ": " + d.value;
        });

      d3.select('#adjacencyG')
        .call(adjacencyMatrix.xAxis);

      d3.select('#adjacencyG')
        .call(adjacencyMatrix.yAxis);
    }
  </script>
</footer>
</html>